<!doctype html><html data-theme=auto lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="Writing down my learning process. Probably mainly Rust, and Java..." name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9d4edd name=theme-color><meta content=#c77dff media=(prefers-color-scheme:dark) name=theme-color><title>Program Branching - azmablog</title><link href=https://blog.azmarach.work/posts/program-branching/ rel=canonical><link href=https://blog.azmarach.work/favicon.png rel=icon type=image/png><link href=https://blog.azmarach.work/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='-.07em' y='.89em' font-size='90'%3Eü¶Ä%3C/text%3E%3C/svg%3E" rel=icon><link title="azmablog - Atom Feed" href=https://blog.azmarach.work/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#9d4edd}[data-theme=dark]{--accent-color:#c77dff}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#c77dff}}</style><link href=https://blog.azmarach.work/style.css rel=stylesheet><link href=https://blog.azmarach.work/icons.css rel=stylesheet><link href=https://blog.azmarach.work/custom.css rel=stylesheet><script defer src=https://blog.azmarach.work/closable.js></script><script defer src=https://blog.azmarach.work/copy-button.js></script><script defer src=https://blog.azmarach.work/theme-switcher.js></script><meta content=azmablog property=og:site_name><meta content="Program Branching - azmablog" property=og:title><meta content=https://blog.azmarach.work/posts/program-branching/ property=og:url><meta content="One of my previous blog articles on basic Java" property=og:description><meta content=https://blog.azmarach.work/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li><a href=https://azmarach.work>üåê ‚Üê Back to main site</a><li id=home><a href=https://blog.azmarach.work> <i class=icon></i>azmablog</a><li class=divider><li><a href=https://blog.azmarach.work/posts>Posts</a><li><a href=https://blog.azmarach.work/code>Code</a><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details></ul></nav></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2024-03-09T00:00:00+00:00">Published on March 09, 2024</time></small><h1>Program Branching</h1><p><small><span>3 minutes read</span><span> ‚Ä¢ </span></small><ul class=tags><a class=tag href=https://blog.azmarach.work/tags>tags:</a><li><a class=tag href=https://blog.azmarach.work/tags/java/>java</a><li><a class=tag href=https://blog.azmarach.work/tags/archive/>archive</a><li><a class=tag href=https://blog.azmarach.work/tags/http/>http</a></ul><br></div><div id=buttons-container><details class=closable id=toc><summary title="Table of Contents"><i class=icon></i></summary> <div><strong class=title>Table of Contents</strong><div><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#java-server>Java server</a><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#main-method>Main method</a><li><a href=https://blog.azmarach.work/posts/program-branching/#httphandler>HttpHandler</a></ul><li><a href=https://blog.azmarach.work/posts/program-branching/#adding-user-input>Adding user input</a><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#vim-moves>Vim moves</a></ul></ul></div></div></details><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a></div><h2>Table of Contents</h2><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#java-server>Java server</a><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#main-method>Main method</a><li><a href=https://blog.azmarach.work/posts/program-branching/#httphandler>HttpHandler</a></ul><li><a href=https://blog.azmarach.work/posts/program-branching/#adding-user-input>Adding user input</a><ul><li><a href=https://blog.azmarach.work/posts/program-branching/#vim-moves>Vim moves</a></ul></ul><p><del>As always, here‚Äôs the video. I look half asleep and mumble a bit, but it‚Äôs beautiful anyway!</del><blockquote class=markdown-alert-note><p>I've deleted my Youtube channel, no more videos available üò∂</blockquote><p>In this video, I continued from <a href=/posts/http-request-without-fw>the previous post</a> about a synchronous HTTP request. This time, I added a simple user input ‚Äî the user can choose which API call the program will make. A small change, but it makes things a bit more fun.<p>For the second endpoint, I created a tiny simulated database on localhost. So in this episode, we‚Äôll try building a mini server. Next time, I‚Äôll take it one step further, as I mention at the end of the video.<h2 id=java-server>Java server</h2><p>I started with an app that serves as a simple HTTP server returning some data on request.<h3 id=main-method>Main method</h3><p>As for libraries, I‚Äôm still sticking to the basics:<pre class=language-java data-lang=java style=color:#c0c5ce;background-color:#2b303b><code class=language-java data-lang=java><span style=color:#b48ead>import </span><span>com.sun.net.httpserver.</span><span style=color:#ebcb8b>HttpServer</span><span>;
</span><span style=color:#b48ead>import </span><span>com.sun.net.httpserver.</span><span style=color:#ebcb8b>HttpExchange</span><span>;
</span><span style=color:#b48ead>import </span><span>com.sun.net.httpserver.</span><span style=color:#ebcb8b>HttpHandler</span><span>;
</span><span>
</span><span style=color:#b48ead>import </span><span>java.io.</span><span style=color:#ebcb8b>IOException</span><span>;
</span><span style=color:#b48ead>import </span><span>java.io.</span><span style=color:#ebcb8b>OutputStream</span><span>;
</span><span style=color:#b48ead>import </span><span>java.net.</span><span style=color:#ebcb8b>InetSocketAddress</span><span>;
</span><span style=color:#b48ead>import </span><span>java.util.</span><span style=color:#ebcb8b>Date</span><span>;
</span><span style=color:#b48ead>import </span><span>java.util.</span><span style=color:#ebcb8b>ArrayList</span><span>;
</span><span style=color:#b48ead>import </span><span>java.util.</span><span style=color:#ebcb8b>List</span><span>;
</span><span style=color:#b48ead>import </span><span>java.util.</span><span style=color:#ebcb8b>StringJoiner</span><span>;
</span></code></pre><p>The main method creates a server listening on port 8080, with a single available endpoint <code>/data</code>.<pre class=language-java data-lang=java style=color:#c0c5ce;background-color:#2b303b><code class=language-java data-lang=java><span style=color:#b48ead>public static</span><span> void </span><span style=color:#bf616a>main</span><span>(</span><span style=color:#ebcb8b>String</span><span style=color:#b48ead>[]</span><span> args) throws </span><span style=color:#ebcb8b>IOException </span><span>{
</span><span>    </span><span style=color:#ebcb8b>HttpServer</span><span> server = </span><span style=color:#ebcb8b>HttpServer</span><span>.</span><span style=color:#bf616a>create</span><span>(</span><span style=color:#b48ead>new </span><span style=color:#ebcb8b>InetSocketAddress</span><span>(</span><span style=color:#d08770>8080</span><span>), </span><span style=color:#d08770>0</span><span>); 
</span><span>
</span><span>    server.</span><span style=color:#bf616a>createContext</span><span>("</span><span style=color:#a3be8c>/data</span><span>", </span><span style=color:#b48ead>new </span><span style=color:#ebcb8b>DataHandler</span><span>());
</span><span>    server.</span><span style=color:#bf616a>setExecutor</span><span>(</span><span style=color:#d08770>null</span><span>);
</span><span>    server.</span><span style=color:#bf616a>start</span><span>();
</span><span>
</span><span>    </span><span style=color:#ebcb8b>System</span><span>.out.</span><span style=color:#bf616a>println</span><span>("</span><span style=color:#a3be8c>Server started on port 8080...</span><span>");
</span><span>}
</span></code></pre><h3 id=httphandler>HttpHandler</h3><p>The class implementing the <code>HttpHandler</code> interface handles incoming <code>GET</code> requests. That‚Äôs what the overridden <code>handle()</code> method does.<p>It receives an <code>HttpExchange</code> object. Then it checks if the request method is <code>GET</code>, prepares the data and headers, and tries to send back a response.<p>I didn‚Äôt bother with covering every edge case here ‚Äî if it‚Äôs a method we don‚Äôt expect, it just returns status code <code>405 Method Not Allowed</code>. That simply means the server understands the request but doesn‚Äôt have an appropriate response for it.<pre class=language-java data-lang=java style=color:#c0c5ce;background-color:#2b303b><code class=language-java data-lang=java><span>@</span><span style=color:#bf616a>Override
</span><span style=color:#b48ead>public</span><span> void </span><span style=color:#bf616a>handle</span><span>(</span><span style=color:#ebcb8b>HttpExchange</span><span> exchange) throws </span><span style=color:#ebcb8b>IOException </span><span>{
</span><span>    </span><span style=color:#b48ead>if </span><span>("</span><span style=color:#a3be8c>GET</span><span>".</span><span style=color:#bf616a>equals</span><span>(exchange.</span><span style=color:#bf616a>getRequestMethod</span><span>())) {
</span><span>
</span><span>        </span><span style=color:#ebcb8b>String</span><span> responseData = </span><span style=color:#bf616a>getUsersAsJson</span><span>();
</span><span>        
</span><span>        exchange.</span><span style=color:#bf616a>sendResponseHeaders</span><span>(</span><span style=color:#d08770>200</span><span>, responseData.</span><span style=color:#bf616a>getBytes</span><span>().length);
</span><span>
</span><span>        </span><span style=color:#b48ead>try </span><span>(</span><span style=color:#ebcb8b>OutputStream</span><span> os = exchange.</span><span style=color:#bf616a>getResponseBody</span><span>()) {
</span><span>            os.</span><span style=color:#bf616a>write</span><span>(responseData.</span><span style=color:#bf616a>getBytes</span><span>());
</span><span>        }
</span><span>    } </span><span style=color:#b48ead>else </span><span>{
</span><span>        exchange.</span><span style=color:#bf616a>sendResponseHeaders</span><span>(</span><span style=color:#d08770>405</span><span>, -</span><span style=color:#d08770>1</span><span>);
</span><span>    }
</span><span>
</span><span>    exchange.</span><span style=color:#bf616a>close</span><span>();
</span><span>}
</span></code></pre><h2 id=adding-user-input>Adding user input</h2><p>Once the server was running and tested, I moved on to modifying the client program to send different requests based on user input. Here‚Äôs what the full class looked like:<pre class=language-java data-lang=java style=color:#c0c5ce;background-color:#2b303b><code class=language-java data-lang=java><span style=color:#b48ead>import </span><span>java.net.</span><span style=color:#ebcb8b>URI</span><span>;
</span><span style=color:#b48ead>import </span><span>java.net.http.</span><span style=color:#ebcb8b>HttpClient</span><span>;
</span><span style=color:#b48ead>import </span><span>java.net.http.</span><span style=color:#ebcb8b>HttpRequest</span><span>;
</span><span style=color:#b48ead>import </span><span>java.net.http.</span><span style=color:#ebcb8b>HttpResponse</span><span>;
</span><span style=color:#b48ead>import </span><span>java.util.</span><span style=color:#ebcb8b>Scanner</span><span>;
</span><span>
</span><span style=color:#b48ead>public class </span><span style=color:#ebcb8b>ContinuousApiCall </span><span style=color:#eff1f5>{
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>    </span><span style=color:#b48ead>public static void </span><span style=color:#8fa1b3>main</span><span style=color:#eff1f5>(</span><span style=color:#ebcb8b>String</span><span style=color:#b48ead>[] </span><span style=color:#bf616a>args</span><span style=color:#eff1f5>) {
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>        </span><span style=color:#ebcb8b>Scanner</span><span style=color:#eff1f5> scanner </span><span>= </span><span style=color:#b48ead>new </span><span style=color:#ebcb8b>Scanner</span><span style=color:#eff1f5>(</span><span style=color:#ebcb8b>System</span><span style=color:#eff1f5>.in); </span><span style=color:#65737e>// read user input
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>        </span><span style=color:#b48ead>while </span><span style=color:#eff1f5>(</span><span style=color:#d08770>true</span><span style=color:#eff1f5>) { </span><span style=color:#65737e>// could be a do-while too, right?
</span><span style=color:#eff1f5>            </span><span style=color:#ebcb8b>System</span><span style=color:#eff1f5>.out.</span><span style=color:#bf616a>println</span><span style=color:#eff1f5>(</span><span>"</span><span style=color:#96b5b4>\n</span><span style=color:#a3be8c>Choose an option:</span><span style=color:#96b5b4>\n</span><span style=color:#a3be8c>1. Get a random activity</span><span style=color:#96b5b4>\n</span><span style=color:#a3be8c>2. Get users</span><span style=color:#96b5b4>\n</span><span style=color:#a3be8c>Type 'exit' to end the program</span><span style=color:#96b5b4>\n</span><span>"</span><span style=color:#eff1f5>);
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#ebcb8b>String</span><span style=color:#eff1f5> userInput </span><span>=</span><span style=color:#eff1f5> scanner.</span><span style=color:#bf616a>nextLine</span><span style=color:#eff1f5>();
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#b48ead>if </span><span style=color:#eff1f5>(userInput.</span><span style=color:#bf616a>equalsIgnoreCase</span><span style=color:#eff1f5>(</span><span>"</span><span style=color:#a3be8c>exit</span><span>"</span><span style=color:#eff1f5>)) {
</span><span style=color:#eff1f5>                </span><span style=color:#b48ead>break</span><span style=color:#eff1f5>;
</span><span style=color:#eff1f5>            }
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#b48ead>int</span><span style=color:#eff1f5> userChoice </span><span>= </span><span style=color:#ebcb8b>Integer</span><span style=color:#eff1f5>.</span><span style=color:#bf616a>parseInt</span><span style=color:#eff1f5>(userInput);
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#ebcb8b>String</span><span style=color:#eff1f5> apiUrl </span><span>= </span><span style=color:#eff1f5>(userChoice </span><span>== </span><span style=color:#d08770>1</span><span style=color:#eff1f5>)
</span><span style=color:#eff1f5>                </span><span>? "</span><span style=color:#a3be8c>https://www.boredapi.com/api/activity</span><span>"
</span><span style=color:#eff1f5>                </span><span>: "</span><span style=color:#a3be8c>http://localhost:8080/data</span><span>"</span><span style=color:#eff1f5>;
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#ebcb8b>HttpClient</span><span style=color:#eff1f5> httpClient </span><span>= </span><span style=color:#ebcb8b>HttpClient</span><span style=color:#eff1f5>.</span><span style=color:#bf616a>newHttpClient</span><span style=color:#eff1f5>();
</span><span style=color:#eff1f5>            
</span><span style=color:#eff1f5>            </span><span style=color:#ebcb8b>HttpRequest</span><span style=color:#eff1f5> request </span><span>= </span><span style=color:#ebcb8b>HttpRequest</span><span style=color:#eff1f5>.</span><span style=color:#bf616a>newBuilder</span><span style=color:#eff1f5>()
</span><span style=color:#eff1f5>                    .</span><span style=color:#bf616a>uri</span><span style=color:#eff1f5>(</span><span style=color:#ebcb8b>URI</span><span style=color:#eff1f5>.</span><span style=color:#bf616a>create</span><span style=color:#eff1f5>(apiUrl))
</span><span style=color:#eff1f5>                    .</span><span style=color:#bf616a>GET</span><span style=color:#eff1f5>()
</span><span style=color:#eff1f5>                    .</span><span style=color:#bf616a>build</span><span style=color:#eff1f5>();
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>            </span><span style=color:#b48ead>try </span><span style=color:#eff1f5>{
</span><span style=color:#eff1f5>                </span><span style=color:#ebcb8b>HttpResponse</span><span style=color:#eff1f5>&lt;</span><span style=color:#ebcb8b>String</span><span style=color:#eff1f5>> response </span><span>=</span><span style=color:#eff1f5> httpClient.</span><span style=color:#bf616a>send</span><span style=color:#eff1f5>(request, </span><span style=color:#ebcb8b>HttpResponse</span><span style=color:#eff1f5>.</span><span style=color:#ebcb8b>BodyHandlers</span><span style=color:#eff1f5>.</span><span style=color:#bf616a>ofString</span><span style=color:#eff1f5>());
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>                </span><span style=color:#ebcb8b>System</span><span style=color:#eff1f5>.out.</span><span style=color:#bf616a>println</span><span style=color:#eff1f5>(</span><span>"</span><span style=color:#a3be8c>Response Code: </span><span>" +</span><span style=color:#eff1f5> response.</span><span style=color:#bf616a>statusCode</span><span style=color:#eff1f5>());
</span><span style=color:#eff1f5>                </span><span style=color:#ebcb8b>System</span><span style=color:#eff1f5>.out.</span><span style=color:#bf616a>println</span><span style=color:#eff1f5>(</span><span>"</span><span style=color:#a3be8c>Response Body:</span><span style=color:#96b5b4>\n</span><span>" +</span><span style=color:#eff1f5> response.</span><span style=color:#bf616a>body</span><span style=color:#eff1f5>());
</span><span style=color:#eff1f5>            } </span><span style=color:#b48ead>catch </span><span style=color:#eff1f5>(</span><span style=color:#ebcb8b>Exception </span><span style=color:#bf616a>e</span><span style=color:#eff1f5>) {
</span><span style=color:#eff1f5>                e.</span><span style=color:#bf616a>printStackTrace</span><span style=color:#eff1f5>();
</span><span style=color:#eff1f5>            }
</span><span style=color:#eff1f5>        }
</span><span style=color:#eff1f5>
</span><span style=color:#eff1f5>        </span><span style=color:#ebcb8b>System</span><span style=color:#eff1f5>.out.</span><span style=color:#bf616a>println</span><span style=color:#eff1f5>(</span><span>"</span><span style=color:#a3be8c>Program ended. Have a great day!</span><span>"</span><span style=color:#eff1f5>);
</span><span style=color:#eff1f5>        scanner.</span><span style=color:#bf616a>close</span><span style=color:#eff1f5>();
</span><span style=color:#eff1f5>    }
</span><span style=color:#eff1f5>}
</span></code></pre><p>At the end, as usual, I also showed my little script that increases terminal font size for recording ‚Äî and why it didn‚Äôt work this time. üòÑ<p>Next time, I plan to run both of these mini programs inside Docker containers, so I can practice Docker Compose and get more comfortable with that workflow.<p>As always, there were a few minor debugging moments and random Vim chaos along the way.<h4 id=vim-moves>Vim moves</h4><p>You know what? I‚Äôll start putting the Vim commands I discover during recording at the end of each post. For example, while writing this one, I was whining that I didn‚Äôt know how to jump to the matching bracket. So I looked it up ‚Äî and hopefully won‚Äôt forget it now. Also found out how to jump back to the previous cursor position.<pre style=color:#c0c5ce;background-color:#2b303b><code><span>%   -> jump to matching pair
</span><span>`'  -> jump back to the previous cursor position 
</span><span>       (I remapped it to `` because the `' combo is annoying on a Czech keyboard)
</span></code></pre></article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://blog.azmarach.work/posts/asynchronous-http-request/> <div class=nav-arrow>Previous</div> <span class=post-title>Asynchronous HTTP Request</span> </a><a class="post-nav-item post-nav-next" href=https://blog.azmarach.work/posts/turning-old-macbook-into-an-ubuntu-server-part-2/> <div class=nav-arrow>Next</div> <span class=post-title>Turning old McBook into an Ubuntu Server - Part 2</span> </a></nav></main><footer id=site-footer><p>¬© azmablog, 2025<p><small>Powered by <a class="link external" rel="noopener nofollow noreferrer" href=https://www.getzola.org>Zola</a> and <a class="link external" rel="noopener nofollow noreferrer" href=https://duckquill.daudix.one>Duckquill</a> </small></footer><span class=hidden id=copy-code-text>Copy Code</span><style>:root{--alert-note-text:"Note";--alert-tip-text:"Tip";--alert-important-text:"Important";--alert-warning-text:"Warning";--alert-caution-text:"Caution"}</style>